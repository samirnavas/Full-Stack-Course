
> bloglist@1.0.0 test
> cross-env NODE_ENV=test node --test

TAP version 13
# [dotenv@17.3.1] injecting env (3) from .env -- tip: ≡ƒöÉ encrypt with Dotenvx: https://dotenvx.com
# connecting to mongodb+srv://samirnavas:Samirnavas8355@bandb-cluster.3zkxjhf.mongodb.net/testBlogList?appName=BandB-Cluster
# connected to MongoDB
# Method: GET
# Path:   /api/blogs
# Body:   undefined
# ---
# Subtest: when there is initially some blogs saved
    # Subtest: blogs are returned as json
    ok 1 - blogs are returned as json
      ---
      duration_ms: 1362.8945
      type: 'test'
      ...
# Method: GET
# Path:   /api/blogs
# Body:   undefined
# ---
    # Subtest: all blogs are returned
    ok 2 - all blogs are returned
      ---
      duration_ms: 131.4512
      type: 'test'
      ...
# Method: GET
# Path:   /api/blogs
# Body:   undefined
# ---
    # Subtest: the unique identifier property of the blog posts is named id
    ok 3 - the unique identifier property of the blog posts is named id
      ---
      duration_ms: 131.1042
      type: 'test'
      ...
    1..3
ok 1 - when there is initially some blogs saved
  ---
  duration_ms: 1626.4139
  type: 'suite'
  ...
# Method: POST
# Path:   /api/blogs
# Body:   {
#   title: 'Canonical string reduction',
#   author: 'Edsger W. Dijkstra',
#   url: 'http://www.cs.utexas.edu/~EWD/transcriptions/EWD08xx/EWD808.html',
#   likes: 12
# }
# ---
# Method: GET
# Path:   /api/blogs
# Body:   undefined
# ---
# Subtest: addition of a new blog
    # Subtest: a valid blog can be added
    ok 1 - a valid blog can be added
      ---
      duration_ms: 187.6099
      type: 'test'
      ...
# Method: POST
# Path:   /api/blogs
# Body:   {
#   title: 'First class tests',
#   author: 'Robert C. Martin',
#   url: 'http://blog.cleancoder.com/uncle-bob/2017/05/05/TestDefinitions.htmll'
# }
# ---
    # Subtest: if likes property is missing from the request, it defaults to 0
    ok 2 - if likes property is missing from the request, it defaults to 0
      ---
      duration_ms: 135.5239
      type: 'test'
      ...
# Method: POST
# Path:   /api/blogs
# Body:   {
#   author: 'Robert C. Martin',
#   url: 'http://blog.cleancoder.com/uncle-bob/2017/05/05/TestDefinitions.htmll',
#   likes: 10
# }
# ---
# Blog validation failed: title: Path `title` is required.
    # Subtest: if title is missing, response is 400 Bad Request
    ok 3 - if title is missing, response is 400 Bad Request
      ---
      duration_ms: 96.4047
      type: 'test'
      ...
# Method: POST
# Path:   /api/blogs
# Body:   {
#   title: 'TDD harms architecture',
#   author: 'Robert C. Martin',
#   likes: 10
# }
# ---
# Blog validation failed: url: Path `url` is required.
    # Subtest: if url is missing, response is 400 Bad Request
    ok 4 - if url is missing, response is 400 Bad Request
      ---
      duration_ms: 90.0439
      type: 'test'
      ...
    1..4
ok 2 - addition of a new blog
  ---
  duration_ms: 510.2515
  type: 'suite'
  ...
# Method: DELETE
# Path:   /api/blogs/699543af79975235a06288ec
# Body:   undefined
# ---
# Subtest: deletion of a blog
    # Subtest: succeeds with status code 204 if id is valid
    ok 1 - succeeds with status code 204 if id is valid
      ---
      duration_ms: 217.9843
      type: 'test'
      ...
    1..1
ok 3 - deletion of a blog
  ---
  duration_ms: 218.6859
  type: 'suite'
  ...
# Method: PUT
# Path:   /api/blogs/699543af79975235a06288f3
# Body:   { likes: 17 }
# ---
# (node:8552) [MONGOOSE] Warning: mongoose: the `new` option for `findOneAndUpdate()` and `findOneAndReplace()` is deprecated. Use `returnDocument: 'after'` instead.
# (Use `node --trace-warnings ...` to show where the warning was created)
# Subtest: updating a blog
    # Subtest: succeeds with status code 200 if id is valid
    ok 1 - succeeds with status code 200 if id is valid
      ---
      duration_ms: 232.3179
      type: 'test'
      ...
    1..1
ok 4 - updating a blog
  ---
  duration_ms: 232.8778
  type: 'suite'
  ...
# Subtest: dummy returns one
ok 5 - dummy returns one
  ---
  duration_ms: 0.9993
  type: 'test'
  ...
# Subtest: total likes
    # Subtest: when list has only one blog, equals the likes of that
    ok 1 - when list has only one blog, equals the likes of that
      ---
      duration_ms: 0.1578
      type: 'test'
      ...
    # Subtest: when list has multiple blogs, equals the sum of likes
    ok 2 - when list has multiple blogs, equals the sum of likes
      ---
      duration_ms: 0.1913
      type: 'test'
      ...
    # Subtest: when list is empty, equals zero
    ok 3 - when list is empty, equals zero
      ---
      duration_ms: 0.0905
      type: 'test'
      ...
    1..3
ok 6 - total likes
  ---
  duration_ms: 0.6929
  type: 'suite'
  ...
# Subtest: favorite blog
    # Subtest: returns the blog with the most likes
    ok 1 - returns the blog with the most likes
      ---
      duration_ms: 0.7735
      type: 'test'
      ...
    # Subtest: returns null for empty list
    ok 2 - returns null for empty list
      ---
      duration_ms: 0.1077
      type: 'test'
      ...
    1..2
ok 7 - favorite blog
  ---
  duration_ms: 1.1155
  type: 'suite'
  ...
# Subtest: most blogs
    # Subtest: returns the author with the most blogs
    ok 1 - returns the author with the most blogs
      ---
      duration_ms: 1.3022
      type: 'test'
      ...
    # Subtest: returns null for empty list
    ok 2 - returns null for empty list
      ---
      duration_ms: 0.1728
      type: 'test'
      ...
    1..2
ok 8 - most blogs
  ---
  duration_ms: 1.7444
  type: 'suite'
  ...
# Subtest: most likes
    # Subtest: returns the author with the most likes
    ok 1 - returns the author with the most likes
      ---
      duration_ms: 0.7028
      type: 'test'
      ...
    # Subtest: returns null for empty list
    ok 2 - returns null for empty list
      ---
      duration_ms: 0.2207
      type: 'test'
      ...
    1..2
ok 9 - most likes
  ---
  duration_ms: 1.0109
  type: 'suite'
  ...
# [dotenv@17.3.1] injecting env (3) from .env -- tip: ≡ƒ¢í∩╕Å auth for agents: https://vestauth.com
# connecting to mongodb+srv://samirnavas:Samirnavas8355@bandb-cluster.3zkxjhf.mongodb.net/testBlogList?appName=BandB-Cluster
# connected to MongoDB
# Method: POST
# Path:   /api/users
# Body:   { username: 'root', name: 'Superuser', password: 'mypassword' }
# ---
# Subtest: addition of a new user
    # Subtest: succeeds with a fresh username
    ok 1 - succeeds with a fresh username
      ---
      duration_ms: 1438.6919
      type: 'test'
      ...
# Method: POST
# Path:   /api/users
# Body:   { username: 'uk', password: 'mypassword' }
# ---
# User validation failed: username: Path `username` (`uk`, length 2) is shorter than the minimum allowed length (3).
    # Subtest: fails if username is too short
    ok 2 - fails if username is too short
      ---
      duration_ms: 109.2273
      type: 'test'
      ...
# Method: POST
# Path:   /api/users
# Body:   { username: 'username', password: 'pw' }
# ---
    # Subtest: fails if password is too short
    ok 3 - fails if password is too short
      ---
      duration_ms: 45.961
      type: 'test'
      ...
# Method: POST
# Path:   /api/users
# Body:   { username: 'root', password: 'mypassword' }
# ---
# Method: POST
# Path:   /api/users
# Body:   { username: 'root', password: 'mypassword' }
# ---
# E11000 duplicate key error collection: testBlogList.users index: username_1 dup key: { username: "root" }
    # Subtest: fails if username is not unique
    not ok 4 - fails if username is not unique
      ---
      duration_ms: 254.2581
      type: 'test'
      location: 'C:\\Programming\\Full-Stack-Course\\part 4\\bloglist\\tests\\user_api.test.js:67:5'
      failureType: 'testCodeFailure'
      error: 'expected 400 "Bad Request", got 500 "Internal Server Error"'
      code: 'ERR_TEST_FAILURE'
      stack: |-
        TestContext.<anonymous> (C:\Programming\Full-Stack-Course\part 4\bloglist\tests\user_api.test.js:81:14)
        process.processTicksAndRejections (node:internal/process/task_queues:105:5)
        async Test.run (node:internal/test_runner/test:1054:7)
        async Suite.processPendingSubtests (node:internal/test_runner/test:744:7)
        Test._assertStatus (C:\Programming\Full-Stack-Course\part 4\bloglist\node_modules\supertest\lib\test.js:309:14)
        C:\Programming\Full-Stack-Course\part 4\bloglist\node_modules\supertest\lib\test.js:365:13
        Test._assertFunction (C:\Programming\Full-Stack-Course\part 4\bloglist\node_modules\supertest\lib\test.js:342:13)
        Test.assert (C:\Programming\Full-Stack-Course\part 4\bloglist\node_modules\supertest\lib\test.js:195:23)
        localAssert (C:\Programming\Full-Stack-Course\part 4\bloglist\node_modules\supertest\lib\test.js:138:14)
        Server.<anonymous> (C:\Programming\Full-Stack-Course\part 4\bloglist\node_modules\supertest\lib\test.js:152:11)
        Object.onceWrapper (node:events:632:28)
        Server.emit (node:events:518:28)
        emitCloseNT (node:net:2419:8)
        process.processTicksAndRejections (node:internal/process/task_queues:89:21)
      ...
    1..4
not ok 10 - addition of a new user
  ---
  duration_ms: 1850.6724
  type: 'suite'
  location: 'C:\\Programming\\Full-Stack-Course\\part 4\\bloglist\\tests\\user_api.test.js:9:1'
  failureType: 'subtestsFailed'
  error: '1 subtest failed'
  code: 'ERR_TEST_FAILURE'
  ...
1..10
# tests 23
# suites 9
# pass 22
# fail 1
# cancelled 0
# skipped 0
# todo 0
# duration_ms 3204.5479
